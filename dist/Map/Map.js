var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.default=Map;var _objectSpread2=_interopRequireDefault(require("@babel/runtime/helpers/objectSpread"));var _react=_interopRequireDefault(require("react"));var _propTypes=_interopRequireDefault(require("prop-types"));var _qs=_interopRequireDefault(require("qs"));var _reactNative=require("react-native");var _Theme=_interopRequireDefault(require("../Theme"));var _jsxFileName="/Users/nacho/projects/el-native/src/Map/Map.js";var theme=_Theme.default.getTheme();var styles=theme.map;var propTypes={latitude:_propTypes.default.number.isRequired,longitude:_propTypes.default.number.isRequired,width:_propTypes.default.number,height:_propTypes.default.number,apiKey:_propTypes.default.string.isRequired,maptype:_propTypes.default.string,zoom:_propTypes.default.number,onPress:_propTypes.default.func,style:_propTypes.default.object,button:_propTypes.default.element,underlayColor:_propTypes.default.string};var defaultProps={width:undefined,height:undefined,maptype:'roadmap',zoom:18,onPress:undefined,style:{},button:undefined,underlayColor:'white'};function Map(props){var dims=_reactNative.Dimensions.get('window');var computedDimensions={width:Math.round(props.width||dims.width),height:Math.round(props.height||dims.width*(2/3))};var googleStaticMapUri=function googleStaticMapUri(){var baseUrl='https://maps.googleapis.com/maps/api/staticmap';var apiKey=props.apiKey;var params={markers:[props.latitude,props.longitude].join(','),maptype:props.maptype,size:[computedDimensions.width,computedDimensions.height].join('x'),scale:2,apiKey:apiKey};var query=_qs.default.stringify(params,{arrayFormat:'brackets'});var url=baseUrl+"?"+query;return url;};var handleOnPress=function handleOnPress(){var generateIos=function generateIos(){return"https://maps.apple.com/?q="+props.latitude+","+props.longitude+"&z="+props.zoom;};var generateAndroid=function generateAndroid(){return"geo:"+props.latitude+","+props.longitude;};var url=_reactNative.Platform.select({ios:generateIos,android:generateAndroid})();_reactNative.Linking.canOpenURL(url).then(function(supported){if(!supported){console.error("Can't handle url: "+url);return;}_reactNative.Linking.openURL(url);}).catch(function(err){return console.error('An error occurred',err);});};var onPress=props.onPress&&typeof props.onPress==='function'?props.onPress:handleOnPress;var renderButton=function renderButton(){return _react.default.createElement(_reactNative.TouchableHighlight,{onPress:onPress,underlayColor:props.underlayColor,style:(0,_objectSpread2.default)({},styles.button,props.style.button),__source:{fileName:_jsxFileName,lineNumber:103}},_react.default.createElement(_reactNative.View,{__source:{fileName:_jsxFileName,lineNumber:108}},props.button||_react.default.createElement(_reactNative.Text,{__source:{fileName:_jsxFileName,lineNumber:108}},"Navigate")));};return _react.default.createElement(_reactNative.View,{style:(0,_objectSpread2.default)({},styles.container,props.style.container),__source:{fileName:_jsxFileName,lineNumber:113}},_react.default.createElement(_reactNative.Image,{source:{uri:googleStaticMapUri()},style:computedDimensions,__source:{fileName:_jsxFileName,lineNumber:114}}),renderButton());}Map.propTypes=propTypes;Map.defaultProps=defaultProps;